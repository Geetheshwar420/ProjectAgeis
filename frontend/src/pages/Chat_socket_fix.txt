// Fix for Socket.IO connection - remove JWT token, use session cookies
// Lines 157-180 in Chat.jsx

    useEffect(() => {
        // Dynamically determine the socket URL based on current hostname
        // Uses page's protocol to prevent mixed-content blocking
        const getSocketUrl = () => {
            if (process.env.REACT_APP_API_URL) {
                return process.env.REACT_APP_API_URL;
            }
            
            // Use the page's current protocol to prevent mixed-content blocking
            const protocol = window.location.protocol; // 'http:' or 'https:'
            const hostname = window.location.hostname || 'localhost';
            const port = process.env.REACT_APP_API_PORT || '5000';
            
            // Construct URL avoiding duplicate slashes
            return `${protocol}//${hostname}:${port}`;
        };
        
        // Session-based auth: no token needed, cookies are sent automatically
        const newSocket = io(getSocketUrl(), {
            withCredentials: true,  // Important: enables cookie sending
            transports: ['websocket', 'polling']
        });
        setSocket(newSocket);

        newSocket.on('new_friend_request', (data) => {
            message.info(`You have a new friend request from ${data.requester}`);
        });

        return () => {
            newSocket.disconnect();
        };
    }, []);
